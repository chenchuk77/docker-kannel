#!/bin/bash

{% for channel in channels %}
##
## autogenerated kannel-{{ channel.msisdn }} docker starter
echo "starting kannel-{{ channel.msisdn }}"
docker run -d --name kannel-{{ channel.msisdn }} \
	   -p {{ channel.http_port }}:13013 \
	   -p {{ channel.smpp.port }}:2776 \
	   --device={{ channel.device }} --cap-add SYS_PTRACE \
           --volume $(readlink -f volumes)/{{ channel.msisdn }}/kannel/etc/:/etc/kannel \
           --volume $(readlink -f volumes)/{{ channel.msisdn }}/kannel/log:/var/log/kannel \
           --volume $(readlink -f volumes)/{{ channel.msisdn }}/kannel/spool:/var/spool/kannel \
           kannelplus:2.1

echo "kannel-{{ channel.msisdn }} started."
sleep 2s
###########################################################
{% endfor %}


{% raw %}
docker ps --format 'table {{.Names}}\t{{.Status}}\t{{.Ports}}'
echo "done."
{% endraw %}




